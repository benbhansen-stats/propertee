<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generate Direct Adjusted Weights for Treatment Effect Estimation — ett • propertee</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate Direct Adjusted Weights for Treatment Effect Estimation — ett"><meta name="description" content="These should primarily be used inside models. See Details.
ate() creates weights to estimate the Average Treatment Effect and
ett() creates weights to estimate Effect of Treatment on the Treated."><meta property="og:description" content="These should primarily be used inside models. See Details.
ate() creates weights to estimate the Average Treatment Effect and
ett() creates weights to estimate Effect of Treatment on the Treated."><meta property="og:image" content="www.github.com/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">propertee</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.4.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Basic</h6></li>
    <li><a class="dropdown-item" href="../articles/intro-to-propertee.html">Introduction to propertee</a></li>
    <li><a class="dropdown-item" href="../articles/not-for-cran/mi_vignette/demo.html">Real-data demonstration with a finely stratified cluster RCT and a broader administrative database</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced</h6></li>
    <li><a class="dropdown-item" href="../articles/non-binary-treatment.html">Non-binary Treatment Specification</a></li>
    <li><a class="dropdown-item" href="../articles/RDD.html">Regression Discontinuity Designs</a></li>
    <li><a class="dropdown-item" href="../articles/not-for-cran/geex_vs_propertee.html">propertee vs. geex</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Theory</h6></li>
    <li><a class="dropdown-item" href="../articles/sandwich_infrastructure.html">Data structures to support standard error calculations for direct adjustment assisted by a prior covariance model</a></li>
    <li><a class="dropdown-item" href="../articles/LinearModelVarianceEstimation.html">Variance Estimation Testing Using A Simple Linear Specification</a></li>
    <li><a class="dropdown-item" href="../articles/design_based_SEs.html">Design based sandwich SEs for differences of Hajek estimators</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/benbhansen-stats/propertee/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generate Direct Adjusted Weights for Treatment Effect Estimation</h1>
      <small class="dont-index">Source: <a href="https://github.com/benbhansen-stats/propertee/blob/main/R/weights.R" class="external-link"><code>R/weights.R</code></a></small>
      <div class="d-none name"><code>WeightCreators.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These should primarily be used inside models. See Details.
<code>ate()</code> creates weights to estimate the Average Treatment Effect and
<code>ett()</code> creates weights to estimate Effect of Treatment on the Treated.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ett</span><span class="op">(</span>design <span class="op">=</span> <span class="cn">NULL</span>, dichotomy <span class="op">=</span> <span class="cn">NULL</span>, by <span class="op">=</span> <span class="cn">NULL</span>, data <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ate</span><span class="op">(</span>design <span class="op">=</span> <span class="cn">NULL</span>, dichotomy <span class="op">=</span> <span class="cn">NULL</span>, by <span class="op">=</span> <span class="cn">NULL</span>, data <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-design">design<a class="anchor" aria-label="anchor" href="#arg-design"></a></dt>
<dd><p>optional; a <code>Design</code> object created by one of
<code><a href="Design_objects.html">rct_design()</a></code>, <code><a href="Design_objects.html">rd_design()</a></code>, or <code><a href="Design_objects.html">obs_design()</a></code>.</p></dd>


<dt id="arg-dichotomy">dichotomy<a class="anchor" aria-label="anchor" href="#arg-dichotomy"></a></dt>
<dd><p>optional; a formula defining the dichotomy of the treatment
variable if it isn't already <code>0</code>/<code>1</code>. See details for more information.
If <code>ett()</code> or <code>ate()</code> is
called within a <code><a href="lmitt.html">lmitt()</a></code> call that specifies a <code>dichotomy</code>
argument, that <code>dichotomy</code> will be used if the argument here has not
been specified.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>optional; named vector or list connecting names of unit of
assignment/ variables in <code>design</code> to unit of
assignment/unitid/cluster variables in <code>data</code>. Names represent
variables in the Design; values represent variables in the data. Only
needed if variable names differ.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>optional; the data for the analysis to be performed on. May be
excluded if these functions are included as the <code>weights</code> argument of
a model.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a <code>WeightedDesign</code> object, which is a vector of numeric weights</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>These functions should primarily be used in the <code>weight</code>
argument of <code><a href="lmitt.html">lmitt()</a></code> or<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>. All arguments are optional if used within
those functions. If used on their own, <code>design</code> and <code>data</code> must
be provided.</p>
<p>In a <code>Design</code> with <code>block</code>s, the weights are generated as a
function of the ratio of the number of treated units in a block versus the
total number of units in a block.</p>
<p>In any blocks where that ratio is 0 or 1 (that is, all units in the block
have the same treatment status), the weights will be 0. In effect this
removes from the target population any block in which there is no basis
for estimating either means under treatment or means under control.</p>
<p>If block is missing for a given observation, a weight of 0 is applied.</p>
<p>A <code>dichotomy</code> is specified by a <code>formula</code> consisting of a
conditional statement on both the left-hand side (identifying treatment
levels associated with "treatment") and the right hand side (identifying
treatment levels associated with "control"). For example, if your
treatment variable was called <code>dose</code> and doses above 250 are
considered treatment, you might write:</p>
<p><code>dichotomy(des) &lt;- dose &gt; 250 ~ dose &lt;= 250</code></p>
<p>The period (<code>.</code>) can be used to assign all other units of assignment.
For example, we could have written the same treatment regime as either</p>
<p><code>dichotomy(des) &lt;- dose &gt; 250 ~ .</code></p>
<p>or</p>
<p><code>dichotomy(des) &lt;- . ~ dose &lt;= 250</code></p>
<p>The <code>dichotomy</code> formula supports Relational Operators (see
<a href="https://rdrr.io/r/base/Comparison.html" class="external-link">Comparison</a>), Logical Operators (see <a href="https://rdrr.io/r/base/Logic.html" class="external-link">Logic</a>), and <code>%in%</code> (see
<code><a href="https://rdrr.io/r/base/match.html" class="external-link">match()</a></code>).</p>
<p>The conditionals need not assign all values of treatment to control or
treatment, for example, <code>dose &gt; 300 ~ dose &lt; 200</code> does not assign
<code>200 &lt;= dose &lt;= 300</code> to either treatment or control. This would be
equivalent to manually generating a binary variable with <code>NA</code>
whenever <code>dose</code> is between 200 and 300. Standard errors will reflect
the sizes of the comparison groups specified by the <code>dichotomy</code>.</p>
<p>Code for the computation of the weights was contributed by Tim Lycurgus.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">simdata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">des</span> <span class="op">&lt;-</span> <span class="fu"><a href="Design_objects.html">rct_design</a></span><span class="op">(</span><span class="va">z</span> <span class="op">~</span> <span class="fu"><a href="DesignSpecials.html">unit_of_assignment</a></span><span class="op">(</span><span class="va">uoa1</span>, <span class="va">uoa2</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">simdata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="lmitt.html">lmitt</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">simdata</span>, design <span class="op">=</span> <span class="va">des</span>, weights <span class="op">=</span> <span class="fu">ate</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lmitt(y ~ 1, data = simdata, design = des, weights = ate())</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Treatment Effects :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std. Error t value Pr(&gt;|t|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> z.   0.1205     0.2301   0.524    0.603</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Std. Error calculated via type "CR0"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Josh Errickson, Josh Wasserman, Ben Hansen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

