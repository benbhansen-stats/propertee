<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Variance/Covariance for teeMod objects — vcov_tee • propertee</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Variance/Covariance for teeMod objects — vcov_tee"><meta name="description" content="Compute robust sandwich variance estimates with optional
covariance adjustment"><meta property="og:description" content="Compute robust sandwich variance estimates with optional
covariance adjustment"><meta property="og:image" content="https://benbhansen-stats.github.io/propertee/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">propertee</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.3.9002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Basic</h6></li>
    <li><a class="dropdown-item" href="../articles/intro-to-propertee.html">Introduction to propertee</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced</h6></li>
    <li><a class="dropdown-item" href="../articles/non-binary-treatment.html">Non-binary Treatment Specification</a></li>
    <li><a class="dropdown-item" href="../articles/RDD.html">Regression Discontinuity Designs</a></li>
    <li><a class="dropdown-item" href="../articles/geex_vs_propertee.html">propertee vs. geex</a></li>
    <li><a class="dropdown-item" href="../articles/mi_vignette/index.html">Real-data demonstration with a finely stratified cluster RCT and a broader administrative database</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/benbhansen-stats/propertee/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Variance/Covariance for <code>teeMod</code> objects</h1>
      <small class="dont-index">Source: <a href="https://github.com/benbhansen-stats/propertee/blob/main/R/SandwichLayerVariance.R" class="external-link"><code>R/SandwichLayerVariance.R</code></a></small>
      <div class="d-none name"><code>var_estimators.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute robust sandwich variance estimates with optional
covariance adjustment</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">vcov_tee</span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="cn">NULL</span>, cluster <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">.vcov_DB0</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">.vcov_DB</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a fitted <code>teeMod</code> model</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>a string indicating the desired bias correction for the residuals
of <code>x</code>. Default makes no bias correction. See Details for supported types</p></dd>


<dt id="arg-cluster">cluster<a class="anchor" aria-label="anchor" href="#arg-cluster"></a></dt>
<dd><p>a vector indicating the columns that define clusters. The default
is the unit of assignment columns in the <code>StudySpecification</code> stored
in <code>x</code>. These columns should appear in the dataframe used for fitting
<code>x</code> as well as the dataframe passed to the covariance model fit in the case of
prior covariance adjustment. See Details</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>arguments to be passed to the internal variance estimation
function, such as <code>cov_adj_rcorrect</code> and <code>loco_residuals</code>. If
<code>x</code> has a <code>SandwichLayer</code> object in its offset, The former
specifies the bias correction to the residuals of the covariance model, and
the latter indicates whether the offset should be replaced with predictions
from leave-one-cluster-out fits of the covariance adjustment model.
See Details</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A variance-covariance matrix with row and column entries for the estimated
coefficients in <code>x</code>, the marginal mean outcome in the control condition,
the marginal mean <code>offset</code> in the control condition (if an <code>offset</code>
is provided), and if a moderator variable is specified in the formula for <code>x</code>,
the mean interaction in the control condition of the outcome and <code>offset</code>
with the moderator variable</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Variance estimates will be clustered on the basis of the columns
provided to <code>cluster</code> (or obtained by the default behavior). As a result,
providing <code>"HCx"</code> or <code>"CRx"</code> to <code>type</code> will produce the same
variance estimate given that <code>cluster</code> remains the same.</p>
<p>With prior covariance adjustment, unless the <code>data</code> argument of the covariance
model fit is the same as the <code>data</code> argument for fitting <code>x</code> and the
<code>StudySpecification</code> of <code>x</code> has been created with a formula of the
form <code>trt_col ~ 1</code>, the column(s) provided to <code>cluster</code> must appear in the
dataframes in both <code>data</code> arguments, even if the clustering structure does
not exist, per se, in the covariance adjustment sample. For instance, in a
finely stratified randomized trial, one might desire standard errors clustered
at the block level, but the covariance adjustment model may include auxiliary
units that did not participate in the trial. In this case, in the <code>data</code>
argument of the fitted covariance model, the column(s) passed to <code>cluster</code>
should have the block ID's for rows overlapping with the <code>data</code> argument
used for fitting <code>x</code>, and NA's for any auxiliary units. <code>vcov_tee()</code>
will treat each row with an NA as its own cluster.</p>
<p>For ITT effect estimates without covariance adjustment, <code>type</code>
corresponds to the variance estimate desired. Supported options include:</p><ul><li><p><code>"MB0"</code>, <code>"HC0"</code>, and <code>"CR0"</code> for model-based HC/CR0 standard errors</p></li>
<li><p><code>"MB1"</code>, <code>"HC1"</code>, and <code>"CR1"</code> for model-based HC/CR1 standard errors
(for <code>"MB1"</code> and <code>"HC1"</code>, this is \(n/(n - 2)\), and for <code>"CR1"</code>,
this is \(g\cdot(n-1)/((g-1)\cdot(n-2))\), where \(g\) is the number of
clusters in the sample used for fitting <code>x</code>)</p></li>
<li><p><code>"MB2"</code>, <code>"HC2"</code>, and <code>"CR2"</code> for model-based HC/CR2 standard errors</p></li>
<li><p><code>"DB0"</code> for design-based HC0 variance estimates</p></li>
</ul><p>The <code>type</code> argument does not correspond to existing variance estimators in
the literature in the case of prior covariance adjustment. It specifies the
bias correction to the residuals of <code>x</code>, but the residuals of the covariance
model are corrected separately based on the <code>cov_adj_rcorrect</code> argument.
The <code>cov_adj_rcorrect</code> argument takes the same options as <code>type</code>
except <code>"DB0"</code>. When the covariance model includes rows in the treatment
condition for fitting, the residuals of <code>x</code> are further corrected by
having the values of <code>offset</code> replaced by predictions that use coefficient
estimates that leave out rows in the same cluster (as defined by the
<code>cluster</code> argument).</p>
<p>Design-based variance estimation is implemented for
<code>teeMod</code> models satisfying requirements including:</p><ul><li><p>The model uses <code>rct_spec</code> as <code>StudySpecification</code></p></li>
<li><p>The model only estimates a main treatment effect</p></li>
</ul></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Josh Errickson, Josh Wasserman, Ben Hansen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

